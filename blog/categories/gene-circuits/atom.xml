<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Gene Circuits | OpenPlant Electrophysiology]]></title>
  <link href="http://calugo.github.io//blog/categories/gene-circuits/atom.xml" rel="self"/>
  <link href="http://calugo.github.io//"/>
  <updated>2017-03-15T22:53:39+00:00</updated>
  <id>http://calugo.github.io//</id>
  <author>
    <name><![CDATA[Franken-Plant Team]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Introduction: Circuits and Excitable Media]]></title>
    <link href="http://calugo.github.io//blog/2017/02/13/Excitable-Media/"/>
    <updated>2017-02-13T23:09:29+00:00</updated>
    <id>http://calugo.github.io//blog/2017/02/13/Excitable-Media</id>
    <content type="html"><![CDATA[<p align="left" style="font-style:italic; color:#290066;"> Circuits: genes, boards and SynBio?</p>
<!-- more -->

<p align="justify">
In this post we take the opportunity to describe the rationale behind this project. The post is not about mathematics it is about circuits and it is also about plants but as we shall see soon enough patterns observed in systems ranging from cells to tissues in muscles such as the  brain and heart and man made devices such as electrical and electronic circuits share features which can be compared and understood with mathematics, however we to keep this to a bare minimum.
</p>

<p align="justify">
The goal of our project is to develop a set of low budget set of experiments which touch several STEM topics to students in a comprehensive fashion using as a conducting thread the topic of excitable systems. By doing so we touch on circuit design, synchronisation and collective phenomena, software development and the internet of things, 3D modelling and printing, microfuidics and then, as described below, by drawing analogies we hope this to be an entry point to  Synthetic Biology (SynBio).</p>

<p align="left" style="font-style:italic; color:#290066;">Chemical Reactions, Clocks and Chaos.</p>

<p align="justify">
Every system which exhibits periodic behaviour is an object which we can call a clock, cardiac pace-maker cells or circaidan cycles for example are well know biological clocks with periods ranging from milliseconds to days or even seasonal periods.</p>

<p>The period of a clock is often an intrinsic property of the system. For example, linear springs for which the restitution force  is  proportional to the displacement $x$  are clocks with a natural frequency (the reciprocal of the period) equal to $\omega_o=(k/m)^\frac{1}{2}$. The constant $k$ is a property of the spring’s material and $m$  stands for the mass of the oscillating particle.</p>

<p align="justify">
Our ability to write and analyse equations which rule the dynamics of the clocks in mechanics and electronics also allow us to design them prior to their physical implementation. It is needless to say that the discovery of universal circuits and pathways in the life sciences is at the very core of many current research endeavours, ranging from evolution and cell specialization to drug development, crop security to mention some and that the possibility of designing and building circuitry using standard components  &#8216;analogous&#8217; to their mechanical and  electronic counterparts is precisely the goal of SynBio.
</p>

<p align="justify">
The linear spring (aka harmonic oscillator) is a very useful idealisation used to describe several systems. For the case of electrical/electronic circuits instead of mass and spring properties the behaviour of the clock is given in terms of the properties of its components, such as resistors $R$, inductors $L$ and capacitors $C$ which regulate changes in time of electrical charge, current and voltages across the circuit, for systems of chemical reactions and gene regulatory circuits (GRN) design is also possible at the theoretical level which then can be build into an electronic circuit under very general conditions.</p>

<p align="justify"> The last paragraph sketches  <strong>the first take home message</strong>
 of our post: dynamical physical systems can be linked to equivalent chemical dynamical systems
 <a href="#Circuits">[1]</a> and in several cases into electrical/electronic circuits. </p>

<p align="justify">
To illustrate the  equivalence we now turn or attention to the Lorenz system as a working example. We choose this for simplicity but the links and experiments described below can and have been done for several other systems relevant to different fields such as the membrane action potential in neurons developed by Hodgkin-Huxley, its reduced version by Fitzhugh-Nagumo, the relaxation oscillatory system by Van der Pol, the chaotic spiral attractor system of Rossler, and many more!
</p>

<p align="left" style="font-style:italic; color:#290066;">The paradigmatic Lorenz system and Chua&#8217;s circuit</p>

<div style="text-align: center;">
<img class="img-responsive" src="/images/xyzchaosB.png" width="700" />
<p align="justify" style="font-size:90%">
Fig. 1: Trajectory in the <i>phase space</i> defined as the space in which the variables x, y and z are plotted against each other, the trajectory is generated as time changes. This particular trajectory corresponds to parameter values where the system is chaotic (it never closes) showing the classical butterfly-like shape. The figure also shows projections of the trajectory over each of the two dimensional subspaces x-y, x-z  and y-z.
</p>
</div>

<p align="left">
The Lorenz system is described by the system of ordinary differential equations below:
</p>

<script type="math/tex; mode=display">% &lt;![CDATA[

\begin {array}{ccl}
\dot{x}& = & \sigma(y-x)\\
\dot{y}& = & x(\rho-z)-y\\
\dot{z}& = & xy-\beta z
\end {array}
 %]]&gt;</script>

<p align="justify">
This elegant system was originally intended to model a three dimensional convective flow and has been studied extensively, it depends of three parameters $\sigma$, $\rho$ and $\beta$ and it can be used not only as a &#8216;weather model&#8217;  but also as a generic model for chemical reactions and as we shall see as a basis for a non-linear tunable circuit. The equivalent reaction network can be found in  <a href="#Circuits">[1]</a>, and is obtained by assumming  three reactive products $X$, $Y$ and $Z$ where $x$, $y$ and $z$ stand for their respective concentrations, and standard &#8220;law of mass action&#8221; type of interaction, then the following a reaction scheme can be derived which is governed by a Lorenz system in the first octant.
</p>

<p align="justify">
The translation into a reaction scheme is slightly elaborate, we only would like to stress the need to include a number of dummy species $A_i$&#8217;s and $P_i$&#8217;s ($i=1,2,&#8230;$). The former are kept at a constant concentration $[A_i]$ whereas the latter are unreactive products, these are introduced to keep the chemical concentrations always positive.
</p>

<p align="justify">
As shown in Figs. 2 and 4 there is a range of parameter values in which the system is periodic and the concentrations are out of phase which can be interpreted as an activation-inhibition process which oscillates back and forth forever. However if we recover the parameter values for the chaotic regime we obtain a temporal signals as the ones shown in Fig. 3.
</p>

<div style="text-align: center;">
<img class="img-responsive" src="/images/xyznctB.png" width="700" />
<p align="justify" style="font-size:90%">
Fig. 2: Solutions of the Lorenz system as a function of time with a parameter set of values which make the orbits periodic.
</p>
</div>

<div style="text-align: center;">
<img class="img-responsive" src="/images/xyztB.png" width="700" />
<p align="justify" style="font-size:90%">
Fig. 3: Solutions of the Lorenz system as a function of time in the chaotic regime, the parameter values are the same as the ones used to produce the double scroll phase space trajectory (Fig. 1).
</p>
</div>

<p align="justify">
The fact that the same circuit topology leads to very different behaviours is the key in our entire discussion. If we think in biological terms we could say that the change in the expression levels of our very nicely periodic system can undergo a severe transition to a chaotic state due to a simple change in one of the intrinsic parameters of the system, this could be  caused for instance by a mutation. The circuit possesses very different &#8216;phenotypes&#8217; despite being described by the same circuitry. We will come back to this later, but first let us take the discussion one step further, into the realm of  designing and building a physical implementation of the system.
</p>

<div style="text-align: center;">
<img class="img-responsive" style="font-size:90%" src="/images/xyznochaosB.png" width="700" />
<p align="justify" style="font-size:90%">
Fig. 4: Periodic orbit of the Lorenz system the parameter values are the same as the ones used to produce the temporal courses shown in Fig. 2.
</p>
</div>

<p align="left" style="font-style:italic; color:#290066;">Engineering chaos in autonomous systems: Chua&#8217;s circuit.</p>

<p align="justify"> Previously, we defined clocks as systems in which the variables under observation are periodic. Implicitly we have being thinking about <strong>autonomous</strong> clocks which means that they are not powered by time varying source of energy, but by a constant force. Also,  we  mentioned that electrical oscillators are built using  <strong>standard passive components</strong> (resistors $R$, capacitors $C$ and inductors $L$).
Simple arrangements of passive elements easily produce self-sustained oscillatory responses. However linearity implies that no matter how we combine such elements, the reponse is always linear and there are no transitions into more complex behaviours.
</p>

<p align="justify">In order for a circuit to exhibit chaotic behaviour it must satisfy:</p>

<ul>
  <li>
    <p>The system most contain at least one non-linear component.</p>
  </li>
  <li>
    <p>At least one of the components must be non-ohmic or <strong>active</strong>.</p>
  </li>
  <li>
    <p>It should contain at least three elements able to store energy.</p>
  </li>
</ul>

<p align="justify">
The above was proven by Leon Chua and collaborators in the mid 1980&#8217;s when they were attempting to build a circuit which could replicate the Lorenz dynamics. Loosely speaking, the solution was found by noticing that chaos can be understood as a mixing process. The solutions to the equations de-correlate to other solutions in the vicinity at an exponential rate and then are pulled back together repeatedly, this phenomena is known as stretching and folding (think of the patterns you observe when you pour coffee into milk and stir).</p>

<p align="justify">
Theoretically and then experimentally the way of introducing the non-linearity into the system is sketched in Fig. 5, there the addition of the active component is shown alongside the response function devised to implement the stretching-folding mechanisms. The non-linearity can be constructed by a three region piece-wise linear resistance function where negative region introduces the active property to the component. The rest of the setup is a parallel implementation of a standard $RLC$ oscillator.</p>

<p align="justify">The Chua circuit is the simplest setup which satisfies the conditions for chaos. Moreover, every continuous three dimensional odd-symmetric and piece-wise linear dynamical system can be mapped into the circuit.  In physical implementations of the circuit, every possible behaviour known in the realm of non-linear dynamics (Hopf bifurcations, period doubling, etc..) is exhibited by the circuit.</p>

<p align="justify"> The proof of Chua&#8217;s <strong>theorems</strong>  are beyond this rather informal presentation, however bear in mind that the <strong>inductive thinking and rigour</strong> which allowed people to achieve these remarkable results is something which be systematically  applied at the moment of designing a circuit.</p>

<div style="text-align: center;">
<img class="img-responsive" src="/images/nrchua.png" width="600" />
<p align="justify" style="font-size:90%">
Fig. 5: Circuit Schematics of the circuit devised by Chua, the key feature is the non-linear diode for which the relationship voltage versus current is illustrated in the right panel.
</p>
</div>

<p align="justify">
In order to go from paper to workbench Figs. 5 and 6 illustrate schematics for the circuit. Figure 6 is particularly cool as it introduces a way to impement the not only the non-linear diode but also a designed replacement for the inductor element, which is not an easy component to find over the counter.</p>
<p align="justify">
The replacement is a <strong>gyrator circuit</strong> and its use makes the connection to SynBio more explicit, we are not only making use of  standard operational amplifiers to generate a new designed behaviour (Chua&#8217;s diode), but also to replace an analogous component with an equivalent digitally designed one!
</p>
<p align="justify">
The full set of component values is well documented in the great site of Valentin Sidersky <a href="http://www.chuacircuits.com/">chuacircuits.com</a>. What we show here largely follows the instructions there, however we do replace the use of the TL082, by a single IC with four operational amplifiers, namely the TL074.
</p>

<div style="text-align: center;">
   <div class="row" align="center">
     <div class="col-xs-6" style="text-align:center">
     <img class="img-responsive" src="/images/chuaXX.png" width="300" />
     </div>
     <div class="col-xs-6" style="text-align:center">
     <img align="center" class="img-responsive" src="/images/gyrator.png" height="300" />
     </div>
    <p align="justify" style="font-size:90%">
    Fig. 6: Chua Circuit showing the diode designed with standard operational amplifiers as active elements (left). An even stronger and easier implementation for this circuit can be achieved replaing the inductor $L$ with a <strong>gyrator circuit</strong>, which provides a current equvalent to that of the inductor, this enforces even more connection with SynBio! As we can also use two standard operational amplifiers to implement the gyrator.
    </p>
  </div>
</div>

<p align="justify">
Fig. 7 shows several iterations of the circuits build for demonstrating purposes, as detailed somewhere in the experiments entry, we have used these to study synchronisation phenomena, our monitoring software and the dynamics of the circuit itself, also the videos below the figure show the circuit in action, we control the transition to chaos by allowing two resistors in the circuit to be adjustable (potentiotemers).</p>

<p align="justify"> In the figure we show an early breadboard version and two soldered versions, the former does use two TL082, but as mentioned in the previous paragraphs we used TL074 IC which enclose four operational amplifiers and make the implementation far simpler.
</p>

<div style="text-align: center;">
  <div class="row" align="center">

    <div class="col-xs-12" style="text-align:center">
    <img class="img-responsive" src="/images/chuasoldered.png" width="270" />
    </div>

    <p align="justify" style="font-size:90%">
   Fig. 6: Our early version of the circuit replacing the inductor by a sythetic one provided by a gyrator circuit.  Detailed description of the circuit can be found in the great page: <a href="http://www.chuacircuits.com/">chuacircuits.com</a></p>

  </div>

  <div class="row" align="center">
      <div class="col-xs-6" style="text-align:center">
      <img class="img-responsive" src="/images/chuacases.jpg" width="250" />
      </div>
      <div class="col-xs-6" style="text-align:center">
      <img class="img-responsive" src="/images/chuacase.jpg" width="270" />
      </div>
      <p align="justify" style="font-size:90%">
      Fig. 6: Our early version of the circuit replacing the inductor by a sythetic one provided by a gyrator circuit.  Detailed description of the circuit can be found in the great page: <a href="http://www.chuacircuits.com/">chuacircuits.com</a></p>
  </div>
</div>

<p align="justify" style="font-size:90%">
Fig. 6 and Movies 1.1-1.2 show our (early) implementation of the circuit, the movies show the transition from a periodic regime into chaos by tinkering with the variable resistor and measuring the voltage in the capacitors $C_1$ and $C_2$.
</p>

<div align="center">
<video width="320" height="240" controls="">
 <source src="/images/chua1.webm" type="video/mp4" />
 Your browser does not support the video tag.
</video>
<p align="justify" style="font-size:90%">
Movie 1.1: Implementation of the circuit, in the video we show the transition from periodic to a single scroll then to a double scroll, the oscilloscope also show the time traces for $C_1$ and $C_2$ which pretty much resemble the ones obtained solving Lorenz equations.
</p>
</div>

<div align="center">
<video width="320" height="240" controls="">
 <source src="/images/chua2.webm" type="video/mp4" />
 Your browser does not support the video tag.
</video>
<p align="justify" style="font-size:90%">
Movie 1.2: The double scroll and the circuit in action!
</p>
</div>

<p align="justify">
So that is it!, that is how one builds a Lorenz-like circuit!, What else then? What about the plants? where does all this fits into plant sciences?, the answer is basically everywhere!. Action potentials triggered by mechanical or chemical stimuli have been studied for a long time as they do exhibit the basic features of an <strong>integrate and fire</strong> oscillator.
</p>

<p align="justify">These type of oscillators are characterised by a set of features such as:</p>

<ul>
  <li>
    <p>All or nothing response to stimuli (unless a threshold is reached)</p>
  </li>
  <li>
    <p>A refractory period (The systems is not able to trigger again unless it has reached its basal level)</p>
  </li>
</ul>
<p>&lt;/p&gt;
&lt;p align=&#8217;justify&#8217;&gt;
In many ways certain plants behave like neurons or myocytes!, spiking violently after a sustained perturbation. This have led to a varied number of investigators to attempt to understand such dynamics
using the techniques described so far.&lt;/p&gt;</p>

<p>Some intedisciplinary teams have taken the research of these systems even further! by trying exploit harness the spiking to engineer sensors and bio-mechanical structures with multiple applications.  (See this excellent review <a href="#plants">[4]</a> for instace.)</p>

<p align="justify"> In our case we are interested in studying several rhythms by coupling certain response plants with electonic circuits which might the trigger some electrical stimuli which then difusses to other plants or on the way back to the plant, we are interested in studying the phenomena called &#8220;synchronisation&#8221;.</p>

<p align="justify">
Chemical   signal carriers and triggers such as those of calcium are yet to be fully characterised for several  plant processes such as growth and interaction with the environment, and our little electrogram machines might be of use to understand such roles which of course in the much more cost effective realm of plant sciences compared to those of neurons or cardiac cells!</p>

<p>Innovation in the phenotype originates at the molecular level in at least one of the three levels of organisation described by genetics, gene regulation circuits and metabolic networks <a href="#Wagner">[1]</a>.</p>

<p align="justify">
This classification of genotype classes which belong to levels of organization scales apart immediatley invites to postulate an analogy with similar systems well studied in the engineering and physical sciences where innovation has evolved not as natural process but also by design.
</p>

<p align="justify">
A way to be explict in the connections
we are trying to build is to briefly present a quintessential example of how innovation by design can go back and forth from an idea to a real life implementation.  Our example coincidentally will also touch a deeper connection between the plant systems we are trying to study and contemporary ideas of &#8220;emergence&#8221; and the nature of the &#8220;laws&#8221; of biology.</p>

<p>Electrophysiology can also assist us to understand certain aspects of the innovation in the phenotype genesis,as hinted earlier, it allows to test  the interplay of the three levels of organisation in which evolution acts: genetics, gene regulation circuits and metabolic networks <a href="#Wagner">[1]</a>.</p>

<p align="justify">
With the aid of SynBio perhaps it will become straightforward to edit, engineer and test the robustness and evolvability  of each of those genotype classes. The full description, results and implementation of our devices is or will be available somewhere else on this project page.
</p>

<p>Finally we strongly recommend to the interested reader with some mathematical literacy the series of articles about circuits <a href="#chaosI">[2]</a> and <a href="#chaosII">[3]</a> about linearity and non-linearity of circuits and the Chua system.</p>

<h2 id="references">References.</h2>

<ol>
  <li>
    <p><a id="Circuits"></a><a href="http://dx.doi.org/10.1063/1.455970">1. Nikola Samardzija, Larry D. Greller and E. Wasserman, J. Chem. Phys. 90, 2296 (1989)</a></p>
  </li>
  <li>
    <p><a id="chaosI"></a><a href="http://www.ee.berkeley.edu/~chua/papers/Kennedy93.pdf">2. M. P. Kennedy Three steps to chaos. I. Evolution
</a></p>
  </li>
  <li>
    <p><a id="chaosII"></a><a href="http://www.eecs.berkeley.edu/~chua/papers/Kennedy93b.pdf">3. M. P. Kennedy Three steps to chaos. II. A Chua’s circuit primer</a></p>
  </li>
  <li>
    <p><a id="plants"></a><a href="http://dx.doi.org/10.1098/rsif.2015.0598">4. Q. Guo et al.J. R. Soc. Interface (2015)
</a></p>
  </li>
  <li>
    <p><a id="Wagner"></a><a href="http://www.ieu.uzh.ch/wagner/papers/Wagner_TIGS_2011.pdf">5. Andreas Wagner, TIGS, 08, 397-410 (2011)</a></p>
  </li>
  <li>
    <p><a id="chuas"></a><a href="http://www.chuacircuits.com/">6. Valentin Sidersky’s Chua’s circuits page</a></p>
  </li>
</ol>
]]></content>
  </entry>
  
</feed>
